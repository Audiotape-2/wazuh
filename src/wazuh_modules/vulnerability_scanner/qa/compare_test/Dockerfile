FROM ubuntu:jammy
RUN apt-get update && apt-get install -y curl lsb-release nano rocksdb-tools sqlite3 git openssh-client openssh-server
RUN curl -LO https://packages-dev.wazuh.com/pre-release/apt/pool/main/w/wazuh-manager/wazuh-manager_4.8.0-1_amd64.deb
RUN dpkg -i wazuh-manager_4.8.0-1_amd64.deb
RUN mkdir -p /var/ossec/tmp && curl -LO https://packages.wazuh.com/deps/vulnerability_model_database/vd_1.0.0_vd_4.8.0.tar.xz && mv vd_1.0.0_vd_4.8.0.tar.xz /var/ossec/tmp

RUN git clone https://github.com/vulsio/vulsctl.git
RUN vulsctl/install-host/install.sh -y
RUN vulsctl/install-host/oval.sh --ubuntu
RUN vulsctl/install-host/oval.sh --debian
RUN vulsctl/install-host/gost.sh --ubuntu
RUN vulsctl/install-host/gost.sh --debian
RUN vulsctl/install-host/cvedb.sh --nvd
RUN vulsctl/install-host/cvedb.sh --fortinet
RUN vulsctl/install-host/exploitdb.sh
RUN vulsctl/install-host/msfdb.sh
RUN vulsctl/install-host/kev.sh
RUN vulsctl/install-host/cti.sh

RUN mv *.sqlite3 /usr/local/bin/
